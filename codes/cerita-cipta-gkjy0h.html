<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CeritaAI - Generator Cerita Interaktif</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --purple: #A8E6CF;
            --pink: #FFD3E1;
            --dark: #2D3436;
            --light: #FFFFFF;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* Header */
        header {
            background: var(--light);
            padding: 20px;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        /* Main Content */
        main {
            flex: 1;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px;
        }

        .view {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home View */
        .hero-section {
            background: var(--light);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .hero-title {
            font-size: 36px;
            color: var(--dark);
            margin-bottom: 15px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-subtitle {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
        }

        .story-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .option-card {
            background: linear-gradient(135deg, var(--pink), var(--purple));
            border-radius: 15px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: rotate(45deg);
            transition: all 0.5s ease;
            opacity: 0;
        }

        .option-card:hover::before {
            opacity: 1;
        }

        .option-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .option-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }

        .option-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .option-desc {
            font-size: 14px;
            color: #555;
        }

        /* Generator View */
        .generator-container {
            background: var(--light);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            transition: all 0.3s ease;
        }

        .step.active {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            transform: scale(1.1);
        }

        .step.completed {
            background: var(--accent);
            color: var(--dark);
        }

        .selection-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .selection-btn {
            padding: 20px;
            border: 2px solid transparent;
            border-radius: 15px;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .selection-btn:hover {
            border-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }

        .selection-btn.selected {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
            border-color: var(--primary);
        }

        .selection-icon {
            font-size: 32px;
            margin-bottom: 10px;
            display: block;
        }

        .selection-text {
            font-size: 16px;
            font-weight: 600;
        }

        .generate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .generate-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .generate-btn:active::after {
            width: 300px;
            height: 300px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Story Display */
        .story-display {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 20px;
            padding: 30px;
            margin-top: 20px;
            box-shadow: var(--shadow);
            display: none;
        }

        .story-display.show {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .story-content {
            background: white;
            border-radius: 15px;
            padding: 25px;
            line-height: 1.8;
            color: var(--dark);
            font-size: 16px;
            position: relative;
        }

        .story-content::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 10px;
            font-size: 60px;
            color: var(--accent);
            opacity: 0.3;
        }

        .story-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .save-btn {
            background: var(--accent);
            color: var(--dark);
        }

        .share-btn {
            background: var(--secondary);
            color: white;
        }

        .new-btn {
            background: var(--primary);
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Library View */
        .library-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .story-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .story-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .story-card-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .story-card-content {
            padding: 20px;
        }

        .story-card-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .story-card-meta {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #999;
        }

        /* Profile View */
        .profile-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: white;
        }

        .profile-name {
            font-size: 24px;
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            padding: 20px;
            background: linear-gradient(135deg, var(--pink), var(--purple));
            border-radius: 15px;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--dark);
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .nav-item {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 3px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            transition: width 0.3s ease;
        }

        .nav-item.active::before {
            width: 50%;
        }

        .nav-item.active .nav-icon {
            color: var(--primary);
            transform: scale(1.2);
        }

        .nav-item.active .nav-label {
            color: var(--primary);
        }

        .nav-icon {
            font-size: 24px;
            color: #999;
            transition: all 0.3s ease;
            display: block;
            margin-bottom: 5px;
        }

        .nav-label {
            font-size: 12px;
            color: #999;
            transition: all 0.3s ease;
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--accent);
            border-top-color: var(--primary);
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .selection-grid {
                grid-template-columns: 1fr;
            }

            .hero-title {
                font-size: 28px;
            }

            .story-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üìö</div>
                <span>CeritaAI</span>
            </div>
        </div>
    </header>

    <main>
        <!-- Home View -->
        <section id="home-view" class="view active">
            <div class="hero-section">
                <h1 class="hero-title">Buat Cerita Ajaibmu</h1>
                <p class="hero-subtitle">Pilih elemen favoritmu dan biarkan AI menciptakan petualangan tak terlupakan</p>
                
                <div class="story-options">
                    <div class="option-card" onclick="navigateToView('generator')">
                        <span class="option-icon">‚ú®</span>
                        <h3 class="option-title">Generator Cerita</h3>
                        <p class="option-desc">Buat cerita baru dengan pilihan kustom</p>
                    </div>
                    <div class="option-card" onclick="showQuickStory()">
                        <span class="option-icon">üé≤</span>
                        <h3 class="option-title">Cerita Acak</h3>
                        <p class="option-desc">Dapatkan kejutan cerita instan</p>
                    </div>
                    <div class="option-card" onclick="navigateToView('library')">
                        <span class="option-icon">üìñ</span>
                        <h3 class="option-title">Perpustakaan</h3>
                        <p class="option-desc">Jelajahi koleksi ceritamu</p>
                    </div>
                    <div class="option-card" onclick="navigateToView('profile')">
                        <span class="option-icon">üë§</span>
                        <h3 class="option-title">Profil</h3>
                        <p class="option-desc">Lihat statistik dan pencapaian</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Generator View -->
        <section id="generator-view" class="view">
            <div class="generator-container">
                <div class="step-indicator">
                    <div class="step active" id="step1">1</div>
                    <div class="step" id="step2">2</div>
                    <div class="step" id="step3">3</div>
                    <div class="step" id="step4">4</div>
                </div>

                <h2 style="text-align: center; margin-bottom: 20px; color: var(--dark);">
                    <span id="step-title">Pilih Genre Cerita</span>
                </h2>

                <div id="selection-container">
                    <!-- Step 1: Genre -->
                    <div id="step1-content" class="selection-grid">
                        <button class="selection-btn" data-value="fantasy" onclick="selectOption(this, 'genre')">
                            <span class="selection-icon">üêâ</span>
                            <span class="selection-text">Fantasi</span>
                        </button>
                        <button class="selection-btn" data-value="scifi" onclick="selectOption(this, 'genre')">
                            <span class="selection-icon">üöÄ</span>
                            <span class="selection-text">Sci-Fi</span>
                        </button>
                        <button class="selection-btn" data-value="mystery" onclick="selectOption(this, 'genre')">
                            <span class="selection-icon">üîç</span>
                            <span class="selection-text">Misteri</span>
                        </button>
                        <button class="selection-btn" data-value="adventure" onclick="selectOption(this, 'genre')">
                            <span class="selection-icon">üó∫Ô∏è</span>
                            <span class="selection-text">Petualangan</span>
                        </button>
                    </div>

                    <!-- Step 2: Character -->
                    <div id="step2-content" class="selection-grid" style="display: none;">
                        <button class="selection-btn" data-value="brave_knight" onclick="selectOption(this, 'character')">
                            <span class="selection-icon">‚öîÔ∏è</span>
                            <span class="selection-text">Ksatria Pemberani</span>
                        </button>
                        <button class="selection-btn" data-value="clever_wizard" onclick="selectOption(this, 'character')">
                            <span class="selection-icon">üßô</span>
                            <span class="selection-text">Penyihir Cerdas</span>
                        </button>
                        <button class="selection-btn" data-value="curious_child" onclick="selectOption(this, 'character')">
                            <span class="selection-icon">üë¶</span>
                            <span class="selection-text">Anak Penasaran</span>
                        </button>
                        <button class="selection-btn" data-value="wise_elder" onclick="selectOption(this, 'character')">
                            <span class="selection-icon">üë¥</span>
                            <span class="selection-text">Manusia Tua Bijak</span>
                        </button>
                    </div>

                    <!-- Step 3: Setting -->
                    <div id="step3-content" class="selection-grid" style="display: none;">
                        <button class="selection-btn" data-value="enchanted_forest" onclick="selectOption(this, 'setting')">
                            <span class="selection-icon">üå≤</span>
                            <span class="selection-text">Hutan Ajaib</span>
                        </button>
                        <button class="selection-btn" data-value="futuristic_city" onclick="selectOption(this, 'setting')">
                            <span class="selection-icon">üèôÔ∏è</span>
                            <span class="selection-text">Kota Masa Depan</span>
                        </button>
                        <button class="selection-btn" data-value="ancient_ruins" onclick="selectOption(this, 'setting')">
                            <span class="selection-icon">üèõÔ∏è</span>
                            <span class="selection-text">Reruntuhan Kuno</span>
                        </button>
                        <button class="selection-btn" data-value="magical_kingdom" onclick="selectOption(this, 'setting')">
                            <span class="selection-icon">üè∞</span>
                            <span class="selection-text">Kerajaan Magis</span>
                        </button>
                    </div>

                    <!-- Step 4: Plot Twist -->
                    <div id="step4-content" class="selection-grid" style="display: none;">
                        <button class="selection-btn" data-value="unexpected_ally" onclick="selectOption(this, 'twist')">
                            <span class="selection-icon">ü§ù</span>
                            <span class="selection-text">Sekutu Tak Terduga</span>
                        </button>
                        <button class="selection-btn" data-value="hidden_treasure" onclick="selectOption(this, 'twist')">
                            <span class="selection-icon">üíé</span>
                            <span class="selection-text">Harta Karun Tersembunyi</span>
                        </button>
                        <button class="selection-btn" data-value="time_travel" onclick="selectOption(this, 'twist')">
                            <span class="selection-icon">‚è∞</span>
                            <span class="selection-text">Perjalanan Waktu</span>
                        </button>
                        <button class="selection-btn" data-value="magical_power" onclick="selectOption(this, 'twist')">
                            <span class="selection-icon">‚ú®</span>
                            <span class="selection-text">Kekuatan Magis</span>
                        </button>
                    </div>
                </div>

                <button class="generate-btn" id="generate-btn" onclick="nextStep()" disabled>
                    Lanjutkan
                </button>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Sedang menciptakan cerita ajaib...</p>
                </div>

                <div class="story-display" id="story-display">
                    <div class="story-content" id="story-content"></div>
                    <div class="story-actions">
                        <button class="action-btn save-btn" onclick="saveStory()">üíæ Simpan</button>
                        <button class="action-btn share-btn" onclick="shareStory()">üì§ Bagikan</button>
                        <button class="action-btn new-btn" onclick="resetGenerator()">üîÑ Baru</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Library View -->
        <section id="library-view" class="view">
            <div class="library-grid" id="library-grid">
                <!-- Story cards will be dynamically added here -->
            </div>
        </section>

        <!-- Profile View -->
        <section id="profile-view" class="view">
            <div class="profile-container">
                <div class="profile-avatar">üë§</div>
                <h2 class="profile-name">Penulis Cerita</h2>
                <p style="color: #666; margin-bottom: 20px;">Level 5 Story Master</p>
                
                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="stories-count">0</div>
                        <div class="stat-label">Cerita Dibuat</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">15</div>
                        <div class="stat-label">Hari Beruntun</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">2.5k</div>
                        <div class="stat-label">Kata Ditulis</div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-container">
            <div class="nav-item active" onclick="navigateToView('home')">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Beranda</span>
            </div>
            <div class="nav-item" onclick="navigateToView('generator')">
                <span class="nav-icon">‚ú®</span>
                <span class="nav-label">Buat</span>
            </div>
            <div class="nav-item" onclick="navigateToView('library')">
                <span class="nav-icon">üìö</span>
                <span class="nav-label">Koleksi</span>
            </div>
            <div class="nav-item" onclick="navigateToView('profile')">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">Profil</span>
            </div>
        </div>
    </nav>

    <script>
        // Global Variables
        let currentStep = 1;
        let storyChoices = {
            genre: '',
            character: '',
            setting: '',
            twist: ''
        };
        let savedStories = JSON.parse(localStorage.getItem('savedStories')) || [];

        // Story Templates
        const storyTemplates = {
            fantasy: {
                brave_knight: {
                    enchanted_forest: "Di tengah hutan ajaib yang berkabut, ksatria pemberani {name} menemukan jalan setapak bercahaya. Setiap langkahnya diiringi nyanyian peri yang memandunya menuju pohon tertua di hutan. Di sana, sebuah pedang suci menanti pemilik sejati yang akan membebaskan kerajaan dari kutukan abadi.",
                    futuristic_city: "Ksatria {name} terbangun di kota masa depan yang megah. Zirahnya yang kuno menjadi perhatian warga yang menggunakan teknologi canggih. Ia harus belajar menyesuaikan diri sambil mencari cara kembali ke zamannya, namun tak disangka ia menemukan misi baru melawan ancaman dari dimensi lain.",
                    ancient_ruins: "Reruntuhan kuno menyimpan rahasia tentang ksatria legendaris {name}. Saat ia menjelajahi lorong-lorong gelap, tembok-tembok batu mulai bersinar dan menampilkan visi masa lalu. Ia menyadari bahwa ia adalah reinkarnasi dari pahlawan yang harus menyelesaikan misi yang tertunda selama ribuan tahun.",
                    magical_kingdom: "Kerajaan magis sedang diguncang kekacauan saat naga jahat mencuri mahkota emas. Ksatria {name} bersumpah akan mengembalikannya. Dengan bantuan kuda terbangnya, ia terbang melewati awan dan bertarung dengan monster-monster mitologis untuk menyelamatkan kerajaan."
                },
                clever_wizard: {
                    enchanted_forest: "Penyihir cerdas {name} menemukan buku mantra kuno di dasar pohon ek raksasa. Setiap halaman berisi sihir yang belum pernah terlihat sebelumnya. Namun, membaca mantra-mantra ini membangkitkan roh-roh hutan yang menguji kebijaksanaannya dengan teka-teki magis.",
                    futuristic_city: "Di kota masa depan, sihir dan teknologi bertabrakan. Penyihir {name} harus menyembunyikan kekuatannya sambil menggunakan pengetahuannya untuk menghentikan AI jahat yang ingin menghapus semua keajaiban dari dunia. Ia menemukan bahwa gabungan sihir dan teknologi adalah kunci keselamatan.",
                    ancient_ruins: "Reruntuhan kuil kuno menyimpan pengetahuan sihir yang hilang. Penyihir {name} memecahkan kode simbol-simbol mistis untuk membuka portal ke dimensi sihir murni. Di sana, ia bertemu dengan penyihir legendaris yang mengajarkan mantra terkuat yang pernah ada.",
                    magical_kingdom: "Kerajaan magis terancam oleh penyihir gelap yang mencuri semua warna dari dunia. {name}, penyihir muda berbakat, harus melakukan perjalanan ke menara tertinggi untuk mengembalikan keajaiban. Dengan tongkat sakti dan buku mantra, ia menghadapi tantangan yang menguji kemampuan sihirnya."
                }
            },
            scifi: {
                brave_knight: {
                    futuristic_city: "Setelah terjebak dalam eksperimen perjalanan waktu, ksatria {name} menemukan dirinya di tahun 3000. Zirahnya dilengkapi dengan teknologi nano, dan pedangnya menjadi plasma blade. Ia menjadi pahlawan cyberpunk yang melawan korporasi jahat yang ingin menguasai waktu.",
                    enchanted_forest: "Planet hutan alien menjadi rumah baru bagi ksatria {name} setelah pesawatnya jatuh. Flora dan fauna yang aneh namun indah mengajarnya cara bertahan hidup. Ia menemukan bahwa hutan ini adalah entitas hidup yang memilihnya sebagai pelindung dari penambang liar.",
                    ancient_ruins: "Di Mars, ksatria {name} menemukan reruntuhan peradaban kuno yang lebih maju dari Bumi. Artefak-artefak alien memberinya kekuatan super dan misi untuk melindungi galaksi dari invasi yang akan datang. Ia menjadi penjaga perdamaian antarplanet.",
                    magical_kingdom: "Kerajaan di bulan Jupiter yang tersembunyi membutuhkan pahlawan. Ksatria {name} dengan baju tempur antigravitasi menjadi harapan terakhir mereka. Ia memimpin pasukan prajurit bulan melawan alien predator yang ingin menguasai sumber energi Jupiter."
                }
            },
            mystery: {
                clever_wizard: {
                    enchanted_forest: "Penyihir {name} menyelidiki hilangnya beberapa peri di hutan ajaib. Jejak-jejak magis membawanya ke kultus gelap yang melakukan ritual terlarang. Ia harus memecahkan teka-teki kuno sebelum bulan purnama tiba untuk menyelamatkan korban selanjutnya.",
                    futuristic_city: "Di kota cyberpunk, penyihir {name} bekerja sebagai detektif paranormal. Kasus hilangnya beberapa ilmuwan membawanya ke konspirasi yang melibatkan perusahaan teknologi dan dunia spirit. Ia menggunakan sihir teknologi untuk mengungkap kebenaran.",
                    ancient_ruins: "Reruntuhan peradaban kuno menyimpan misteri kematian massal. Penyihir {name} menggunakan divinasi untuk berkomunikasi dengan roh-roh yang terperangkap. Ia menemukan bahwa kutukan kuno akan bangkit kembali jika artefak utama tidak dikembalikan ke tempatnya.",
                    magical_kingdom: "Kerajaan dikejutkan oleh serangkaian pencurian artefak magis. Penyihir {name} ditunjuk untuk mengungkap pencuri misterius yang selalu meninggalkan petunjuk berupa teka-teki sihir. Setiap petunjuk membawanya lebih dekat ke konspirasi di istana."
                }
            },
            adventure: {
                curious_child: {
                    enchanted_forest: "Anak penasaran {name} mengikuti kupu-kupu bercahaya ke dalam hutan ajaib. Di sana, ia bertemu dengan makhluk-makhluk mitologis yang ramah dan memintanya untuk membantu menyembuhkan pohon kehidupan yang sedang sekarat. Petualangan kecil ini mengubahnya menjadi pahlawan mini.",
                    futuristic_city: "Di kota masa depan, {name} menemukan robot tua yang ternyata adalah penjelajah waktu. Mereka melakukan perjalanan ke berbagai era untuk mengumpulkan bagian-bagian yang hilang. Setiap perjalanan mengajarkan mereka tentang sejarah dan persahabatan.",
                    ancient_ruins: "Bermain di dekat reruntuhan, {name} menemukan peta harta karun kuno. Dengan kompas tua dan petunjuk misterius, ia menjelajahi gua-gua tersembunyi dan menghindari jebakan kuno. Harta karun yang ditemukan bukan emas, tetapi buku harian penjelajah legendaris.",
                    magical_kingdom: "{name} secara tidak sengaja masuk ke kerajaan mini di bawah akar pohon. Ratu peri meminta bantuan untuk mengembalikan kristal pelangi yang dicuri oleh goblin. Dengan keberanian dan imajinasi, anak ini memimpin pasukan peri untuk pertempuran epik yang lucu."
                }
            }
        };

        // Plot Twists
        const plotTwists = {
            unexpected_ally: "Tiba-tiba, musuh bebuyutan mereka muncul dan menawarkan bantuan. Ternyata mereka memiliki musuh yang sama dan harus bekerja sama untuk menghadangkan ancaman yang lebih besar.",
            hidden_treasure: "Di balik semua petualangan, mereka menemukan harta karun legendaris yang tidak hanya membuat mereka kaya, tetapi juga memberikan kekuatan untuk melindungi orang-orang yang mereka cintai.",
            time_travel: "Sebuah portal waktu terbuka secara tak terduga, membawa mereka ke masa depan atau masa lalu. Mereka harus menemukan cara kembali sambil mengubah peristiwa penting dalam sejarah.",
            magical_power: "Karakter utama tiba-tiba membangkitkan kekuatan magis tersembunyi yang selama ini tidur di dalam dirinya. Kekuatan ini menjadi kunci untuk menyelesaikan misi mereka."
        };

        // Navigation
        function navigateToView(viewName) {
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // Show selected view
            document.getElementById(`${viewName}-view`).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const navItems = document.querySelectorAll('.nav-item');
            const viewIndex = ['home', 'generator', 'library', 'profile'].indexOf(viewName);
            if (viewIndex !== -1) {
                navItems[viewIndex].classList.add('active');
            }

            // Load library if needed
            if (viewName === 'library') {
                loadLibrary();
            }
        }

        // Generator Functions
        function selectOption(button, type) {
            // Remove previous selection
            document.querySelectorAll(`#step${currentStep}-content .selection-btn`).forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Add selection to clicked button
            button.classList.add('selected');
            
            // Store choice
            storyChoices[type] = button.dataset.value;
            
            // Enable next button
            document.getElementById('generate-btn').disabled = false;
            document.getElementById('generate-btn').textContent = currentStep < 4 ? 'Lanjutkan' : 'Buat Cerita';
        }

        function nextStep() {
            if (currentStep < 4) {
                // Mark current step as completed
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.add('completed');
                
                // Hide current content
                document.getElementById(`step${currentStep}-content`).style.display = 'none';
                
                // Move to next step
                currentStep++;
                
                // Update UI
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.getElementById(`step${currentStep}-content`).style.display = 'grid';
                
                // Update title
                const titles = ['Pilih Genre Cerita', 'Pilih Karakter Utama', 'Pilih Latar Cerita', 'Pilih Twist Menarik'];
                document.getElementById('step-title').textContent = titles[currentStep - 1];
                
                // Reset button
                document.getElementById('generate-btn').disabled = true;
                document.getElementById('generate-btn').textContent = 'Lanjutkan';
            } else {
                generateStory();
            }
        }

        function generateStory() {
            // Show loading
            document.getElementById('loading').classList.add('show');
            document.getElementById('generate-btn').style.display = 'none';
            
            // Simulate API call
            setTimeout(() => {
                // Generate story based on choices
                let story = getStoryFromChoices();
                
                // Hide loading
                document.getElementById('loading').classList.remove('show');
                
                // Show story
                document.getElementById('story-content').textContent = story;
                document.getElementById('story-display').classList.add('show');
                
                // Update stats
                updateStats();
            }, 2000);
        }

        function getStoryFromChoices() {
            const name = "Alex"; // Default name
            let baseStory = "";
            
            // Get base story from template
            if (storyTemplates[storyChoices.genre] && 
                storyTemplates[storyChoices.genre][storyChoices.character] &&
                storyTemplates[storyChoices.genre][storyChoices.character][storyChoices.setting]) {
                baseStory = storyTemplates[storyChoices.genre][storyChoices.character][storyChoices.setting];
            } else {
                // Fallback story
                baseStory = "Di sebuah tempat yang jauh, {name} memulai petualangan luar biasa. Dengan keberanian dan kebijaksanaan, mereka menghadapi tantangan yang tak terduga dan menemukan keajaiban di setiap langkah.";
            }
            
            // Replace name placeholder
            baseStory = baseStory.replace(/{name}/g, name);
            
            // Add plot twist
            if (plotTwists[storyChoices.twist]) {
                baseStory += " " + plotTwists[storyChoices.twist];
            }
            
            // Add ending
            baseStory += " Akhirnya, setelah melalui banyak petualangan, mereka kembali sebagai pahlawan yang telah berubah dan lebih bijaksana. Kisah mereka akan diceritakan selama bertahun-tahun sebagai inspirasi bagi generasi mendatang.";
            
            return baseStory;
        }

        function resetGenerator() {
            currentStep = 1;
            storyChoices = {
                genre: '',
                character: '',
                setting: '',
                twist: ''
            };
            
            // Reset UI
            document.querySelectorAll('.step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index === 0) step.classList.add('active');
            });
            
            document.querySelectorAll('[id$="-content"]').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById('step1-content').style.display = 'grid';
            
            document.querySelectorAll('.selection-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            document.getElementById('step-title').textContent = 'Pilih Genre Cerita';
            document.getElementById('generate-btn').style.display = 'block';
            document.getElementById('generate-btn').disabled = true;
            document.getElementById('generate-btn').textContent = 'Lanjutkan';
            document.getElementById('story-display').classList.remove('show');
        }

        function showQuickStory() {
            navigateToView('generator');
            
            // Auto-select random options
            const genres = ['fantasy', 'scifi', 'mystery', 'adventure'];
            const characters = ['brave_knight', 'clever_wizard', 'curious_child', 'wise_elder'];
            const settings = ['enchanted_forest', 'futuristic_city', 'ancient_ruins', 'magical_kingdom'];
            const twists = ['unexpected_ally', 'hidden_treasure', 'time_travel', 'magical_power'];
            
            // Simulate quick selection
            setTimeout(() => {
                document.querySelector('[data-value="fantasy"]').click();
                setTimeout(() => {
                    document.getElementById('generate-btn').click();
                    setTimeout(() => {
                        document.querySelector('[data-value="brave_knight"]').click();
                        setTimeout(() => {
                            document.getElementById('generate-btn').click();
                            setTimeout(() => {
                                document.querySelector('[data-value="enchanted_forest"]').click();
                                setTimeout(() => {
                                    document.getElementById('generate-btn').click();
                                    setTimeout(() => {
                                        document.querySelector('[data-value="magical_power"]').click();
                                        setTimeout(() => {
                                            document.getElementById('generate-btn').click();
                                        }, 300);
                                    }, 300);
                                }, 300);
                            }, 300);
                        }, 300);
                    }, 300);
                }, 300);
            }, 500);
        }

        // Library Functions
        function loadLibrary() {
            const libraryGrid = document.getElementById('library-grid');
            libraryGrid.innerHTML = '';
            
            if (savedStories.length === 0) {
                libraryGrid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: white;">
                        <h3>Belum ada cerita tersimpan</h3>
                        <p>Mulai buat cerita pertamamu sekarang!</p>
                    </div>
                `;
            } else {
                savedStories.forEach((story, index) => {
                    const storyCard = document.createElement('div');
                    storyCard.className = 'story-card';
                    storyCard.innerHTML = `
                        <img src="https://picsum.photos/seed/story${index}/300/150" alt="Story ${index + 1}" class="story-card-image">
                        <div class="story-card-content">
                            <h3 class="story-card-title">Cerita ${index + 1}</h3>
                            <div class="story-card-meta">
                                <span>${story.genre}</span>
                                <span>${new Date(story.date).toLocaleDateString('id-ID')}</span>
                            </div>
                        </div>
                    `;
                    storyCard.onclick = () => viewStory(index);
                    libraryGrid.appendChild(storyCard);
                });
            }
        }

        function saveStory() {
            const story = {
                content: document.getElementById('story-content').textContent,
                choices: {...storyChoices},
                date: new Date().toISOString(),
                genre: getGenreLabel(storyChoices.genre)
            };
            
            savedStories.push(story);
            localStorage.setItem('savedStories', JSON.stringify(savedStories));
            
            // Show success message
            const saveBtn = document.querySelector('.save-btn');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '‚úÖ Tersimpan!';
            setTimeout(() => {
                saveBtn.innerHTML = originalText;
            }, 2000);
        }

        function viewStory(index) {
            const story = savedStories[index];
            document.getElementById('story-content').textContent = story.content;
            navigateToView('generator');
            document.getElementById('story-display').classList.add('show');
        }

        function shareStory() {
            const storyText = document.getElementById('story-content').textContent;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Cerita dari CeritaAI',
                    text: storyText.substring(0, 200) + '...',
                    url: window.location.href
                });
            } else {
                // Fallback: Copy to clipboard
                navigator.clipboard.writeText(storyText);
                const shareBtn = document.querySelector('.share-btn');
                const originalText = shareBtn.innerHTML;
                shareBtn.innerHTML = '‚úÖ Disalin!';
                setTimeout(() => {
                    shareBtn.innerHTML = originalText;
                }, 2000);
            }
        }

        function getGenreLabel(genre) {
            const labels = {
                fantasy: 'Fantasi',
                scifi: 'Sci-Fi',
                mystery: 'Misteri',
                adventure: 'Petualangan'
            };
            return labels[genre] || 'Umum';
        }

        function updateStats() {
            const storiesCount = document.getElementById('stories-count');
            storiesCount.textContent = savedStories.length + 1; // +1 for current story
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved stories count
            updateStats();
        });
    </script>
</body>
</html>